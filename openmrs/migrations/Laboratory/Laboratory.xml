<?xml version="1.0" encoding="UTF-8"?>

<databaseChangeLog
    xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd
    http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">

    <changeSet id="MALAWI_CONFIG_20210914112404024" author="Tarun">
        <comment>Adding Concepts for Laboratory Form</comment>
        <sqlFile path="openmrs/data/configuration/liquibase/Laboratory/Laboratory.sql"/>
    </changeSet>

    <changeSet id="MALAWI_CONFIG_20210914112405026" author="Tarun">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("Baseline", "Regular follow up visit", "Other")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "LB, Type of visit");
            </sqlCheck>
        </preConditions>
        <comment>Adding Answers to LB, Type of visit</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "LB, Type of visit" and
            concept_name_type = "FULLY_SPECIFIED" and locale = "en" and voided = 0;
            set @child1_concept_id = 0;
            set @child2_concept_id = 0;
            set @child3_concept_id = 0;
            select concept_id into @child1_concept_id from concept_name where name ="Baseline" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child2_concept_id from concept_name where name ="Regular follow up visit" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child3_concept_id from concept_name where name ="Other" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            call add_concept_answer(@concept_id, @child1_concept_id, 1);
            call add_concept_answer(@concept_id, @child2_concept_id, 2);
            call add_concept_answer(@concept_id, @child3_concept_id, 3);
        </sql>
    </changeSet>

    <changeSet id="MALAWI_CONFIG_20210914112405788" author="Tarun">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("Negative", "Positive")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "LB, Rapid test for malaria");
            </sqlCheck>
        </preConditions>
        <comment>Adding Answers to LB, Rapid test for malaria</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "LB, Rapid test for malaria" and
            concept_name_type = "FULLY_SPECIFIED" and locale = "en" and voided = 0;
            set @child1_concept_id = 0;
            set @child2_concept_id = 0;
            select concept_id into @child1_concept_id from concept_name where name ="Negative" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child2_concept_id from concept_name where name ="Positive" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            call add_concept_answer(@concept_id, @child1_concept_id, 1);
            call add_concept_answer(@concept_id, @child2_concept_id, 2);
        </sql>
    </changeSet>

    <changeSet id="MALAWI_CONFIG_20210914112406561" author="Tarun">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("Negative", "Positive")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "LB, Urine pregnancy test");
            </sqlCheck>
        </preConditions>
        <comment>Adding Answers to LB, Urine pregnancy test</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "LB, Urine pregnancy test" and
            concept_name_type = "FULLY_SPECIFIED" and locale = "en" and voided = 0;
            set @child1_concept_id = 0;
            set @child2_concept_id = 0;
            select concept_id into @child1_concept_id from concept_name where name ="Negative" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child2_concept_id from concept_name where name ="Positive" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            call add_concept_answer(@concept_id, @child1_concept_id, 1);
            call add_concept_answer(@concept_id, @child2_concept_id, 2);
        </sql>
    </changeSet>

    <changeSet id="MALAWI_CONFIG_20210914112407693" author="Tarun">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("Positive", "Negative", "Not done")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "LB, Urine protein (dip stick)");
            </sqlCheck>
        </preConditions>
        <comment>Adding Answers to LB, Urine protein (dip stick)</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "LB, Urine protein (dip stick)" and
            concept_name_type = "FULLY_SPECIFIED" and locale = "en" and voided = 0;
            set @child1_concept_id = 0;
            set @child2_concept_id = 0;
            set @child3_concept_id = 0;
            select concept_id into @child1_concept_id from concept_name where name ="Positive" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child2_concept_id from concept_name where name ="Negative" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child3_concept_id from concept_name where name ="Not done" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            call add_concept_answer(@concept_id, @child1_concept_id, 1);
            call add_concept_answer(@concept_id, @child2_concept_id, 2);
            call add_concept_answer(@concept_id, @child3_concept_id, 3);
        </sql>
    </changeSet>

    <changeSet id="MALAWI_CONFIG_20210914112408795" author="Tarun">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("Positive", "Negative", "Not done")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "LB, Urine dipstick for blood");
            </sqlCheck>
        </preConditions>
        <comment>Adding Answers to LB, Urine dipstick for blood</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "LB, Urine dipstick for blood" and
            concept_name_type = "FULLY_SPECIFIED" and locale = "en" and voided = 0;
            set @child1_concept_id = 0;
            set @child2_concept_id = 0;
            set @child3_concept_id = 0;
            select concept_id into @child1_concept_id from concept_name where name ="Positive" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child2_concept_id from concept_name where name ="Negative" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child3_concept_id from concept_name where name ="Not done" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            call add_concept_answer(@concept_id, @child1_concept_id, 1);
            call add_concept_answer(@concept_id, @child2_concept_id, 2);
            call add_concept_answer(@concept_id, @child3_concept_id, 3);
        </sql>
    </changeSet>

    <changeSet id="MALAWI_CONFIG_20210914112410068" author="Tarun">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("Negative", "Trace", "1+", "2+", "3+", "4+")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "LB, Urine nitrite test");
            </sqlCheck>
        </preConditions>
        <comment>Adding Answers to LB, Urine nitrite test</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "LB, Urine nitrite test" and
            concept_name_type = "FULLY_SPECIFIED" and locale = "en" and voided = 0;
            set @child1_concept_id = 0;
            set @child2_concept_id = 0;
            set @child3_concept_id = 0;
            set @child4_concept_id = 0;
            set @child5_concept_id = 0;
            set @child6_concept_id = 0;
            select concept_id into @child1_concept_id from concept_name where name ="Negative" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child2_concept_id from concept_name where name ="Trace" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child3_concept_id from concept_name where name ="1+" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child4_concept_id from concept_name where name ="2+" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child5_concept_id from concept_name where name ="3+" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child6_concept_id from concept_name where name ="4+" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            call add_concept_answer(@concept_id, @child1_concept_id, 1);
            call add_concept_answer(@concept_id, @child2_concept_id, 2);
            call add_concept_answer(@concept_id, @child3_concept_id, 3);
            call add_concept_answer(@concept_id, @child4_concept_id, 4);
            call add_concept_answer(@concept_id, @child5_concept_id, 5);
            call add_concept_answer(@concept_id, @child6_concept_id, 6);
        </sql>
    </changeSet>

    <changeSet id="MALAWI_CONFIG_20210914112411322" author="Tarun">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("Positive", "Negative", "Not done")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "LB, Urine leukocyte esterase test");
            </sqlCheck>
        </preConditions>
        <comment>Adding Answers to LB, Urine leukocyte esterase test</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "LB, Urine leukocyte esterase test" and
            concept_name_type = "FULLY_SPECIFIED" and locale = "en" and voided = 0;
            set @child1_concept_id = 0;
            set @child2_concept_id = 0;
            set @child3_concept_id = 0;
            select concept_id into @child1_concept_id from concept_name where name ="Positive" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child2_concept_id from concept_name where name ="Negative" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child3_concept_id from concept_name where name ="Not done" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            call add_concept_answer(@concept_id, @child1_concept_id, 1);
            call add_concept_answer(@concept_id, @child2_concept_id, 2);
            call add_concept_answer(@concept_id, @child3_concept_id, 3);
        </sql>
    </changeSet>

    <changeSet id="MALAWI_CONFIG_20210914112412347" author="Tarun">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("Positive", "Negative", "Not done")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "LB, Glucose measurement, qualitative, urine");
            </sqlCheck>
        </preConditions>
        <comment>Adding Answers to LB, Glucose measurement, qualitative, urine</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "LB, Glucose measurement, qualitative, urine" and
            concept_name_type = "FULLY_SPECIFIED" and locale = "en" and voided = 0;
            set @child1_concept_id = 0;
            set @child2_concept_id = 0;
            set @child3_concept_id = 0;
            select concept_id into @child1_concept_id from concept_name where name ="Positive" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child2_concept_id from concept_name where name ="Negative" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child3_concept_id from concept_name where name ="Not done" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            call add_concept_answer(@concept_id, @child1_concept_id, 1);
            call add_concept_answer(@concept_id, @child2_concept_id, 2);
            call add_concept_answer(@concept_id, @child3_concept_id, 3);
        </sql>
    </changeSet>

    <changeSet id="MALAWI_CONFIG_20210914112413648" author="Tarun">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("Negative", "Trace", "1+", "2+", "3+", "4+")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "LB, Urine ketone test");
            </sqlCheck>
        </preConditions>
        <comment>Adding Answers to LB, Urine ketone test</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "LB, Urine ketone test" and
            concept_name_type = "FULLY_SPECIFIED" and locale = "en" and voided = 0;
            set @child1_concept_id = 0;
            set @child2_concept_id = 0;
            set @child3_concept_id = 0;
            set @child4_concept_id = 0;
            set @child5_concept_id = 0;
            set @child6_concept_id = 0;
            select concept_id into @child1_concept_id from concept_name where name ="Negative" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child2_concept_id from concept_name where name ="Trace" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child3_concept_id from concept_name where name ="1+" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child4_concept_id from concept_name where name ="2+" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child5_concept_id from concept_name where name ="3+" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child6_concept_id from concept_name where name ="4+" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            call add_concept_answer(@concept_id, @child1_concept_id, 1);
            call add_concept_answer(@concept_id, @child2_concept_id, 2);
            call add_concept_answer(@concept_id, @child3_concept_id, 3);
            call add_concept_answer(@concept_id, @child4_concept_id, 4);
            call add_concept_answer(@concept_id, @child5_concept_id, 5);
            call add_concept_answer(@concept_id, @child6_concept_id, 6);
        </sql>
    </changeSet>

    <changeSet id="MALAWI_CONFIG_20210914112414949" author="Tarun">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("Negative", "Trace", "1+", "2+", "3+", "4+")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "LB, Bilirubin total presence in urine by test strip");
            </sqlCheck>
        </preConditions>
        <comment>Adding Answers to LB, Bilirubin total presence in urine by test strip</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "LB, Bilirubin total presence in urine by test strip" and
            concept_name_type = "FULLY_SPECIFIED" and locale = "en" and voided = 0;
            set @child1_concept_id = 0;
            set @child2_concept_id = 0;
            set @child3_concept_id = 0;
            set @child4_concept_id = 0;
            set @child5_concept_id = 0;
            set @child6_concept_id = 0;
            select concept_id into @child1_concept_id from concept_name where name ="Negative" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child2_concept_id from concept_name where name ="Trace" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child3_concept_id from concept_name where name ="1+" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child4_concept_id from concept_name where name ="2+" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child5_concept_id from concept_name where name ="3+" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child6_concept_id from concept_name where name ="4+" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            call add_concept_answer(@concept_id, @child1_concept_id, 1);
            call add_concept_answer(@concept_id, @child2_concept_id, 2);
            call add_concept_answer(@concept_id, @child3_concept_id, 3);
            call add_concept_answer(@concept_id, @child4_concept_id, 4);
            call add_concept_answer(@concept_id, @child5_concept_id, 5);
            call add_concept_answer(@concept_id, @child6_concept_id, 6);
        </sql>
    </changeSet>

    <changeSet id="MALAWI_CONFIG_20210914112416046" author="Tarun">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("Positive", "Negative", "Not done")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "LB, Urobilinogen");
            </sqlCheck>
        </preConditions>
        <comment>Adding Answers to LB, Urobilinogen</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "LB, Urobilinogen" and
            concept_name_type = "FULLY_SPECIFIED" and locale = "en" and voided = 0;
            set @child1_concept_id = 0;
            set @child2_concept_id = 0;
            set @child3_concept_id = 0;
            select concept_id into @child1_concept_id from concept_name where name ="Positive" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child2_concept_id from concept_name where name ="Negative" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child3_concept_id from concept_name where name ="Not done" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            call add_concept_answer(@concept_id, @child1_concept_id, 1);
            call add_concept_answer(@concept_id, @child2_concept_id, 2);
            call add_concept_answer(@concept_id, @child3_concept_id, 3);
        </sql>
    </changeSet>

    <changeSet id="MALAWI_CONFIG_20210914112417117" author="Tarun">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("Growth", "No Growth", "Not done")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "LB, Blood culture result");
            </sqlCheck>
        </preConditions>
        <comment>Adding Answers to LB, Blood culture result</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "LB, Blood culture result" and
            concept_name_type = "FULLY_SPECIFIED" and locale = "en" and voided = 0;
            set @child1_concept_id = 0;
            set @child2_concept_id = 0;
            set @child3_concept_id = 0;
            select concept_id into @child1_concept_id from concept_name where name ="Growth" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child2_concept_id from concept_name where name ="No Growth" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child3_concept_id from concept_name where name ="Not done" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            call add_concept_answer(@concept_id, @child1_concept_id, 1);
            call add_concept_answer(@concept_id, @child2_concept_id, 2);
            call add_concept_answer(@concept_id, @child3_concept_id, 3);
        </sql>
    </changeSet>

    <changeSet id="MALAWI_CONFIG_20210914112418689" author="Tarun">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("O+", "O-", "A+", "A-", "B+", "B-", "AB+", "AB-")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "LB, Blood typing");
            </sqlCheck>
        </preConditions>
        <comment>Adding Answers to LB, Blood typing</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "LB, Blood typing" and
            concept_name_type = "FULLY_SPECIFIED" and locale = "en" and voided = 0;
            set @child1_concept_id = 0;
            set @child2_concept_id = 0;
            set @child3_concept_id = 0;
            set @child4_concept_id = 0;
            set @child5_concept_id = 0;
            set @child6_concept_id = 0;
            set @child7_concept_id = 0;
            set @child8_concept_id = 0;
            select concept_id into @child1_concept_id from concept_name where name ="O+" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child2_concept_id from concept_name where name ="O-" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child3_concept_id from concept_name where name ="A+" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child4_concept_id from concept_name where name ="A-" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child5_concept_id from concept_name where name ="B+" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child6_concept_id from concept_name where name ="B-" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child7_concept_id from concept_name where name ="AB+" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child8_concept_id from concept_name where name ="AB-" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            call add_concept_answer(@concept_id, @child1_concept_id, 1);
            call add_concept_answer(@concept_id, @child2_concept_id, 2);
            call add_concept_answer(@concept_id, @child3_concept_id, 3);
            call add_concept_answer(@concept_id, @child4_concept_id, 4);
            call add_concept_answer(@concept_id, @child5_concept_id, 5);
            call add_concept_answer(@concept_id, @child6_concept_id, 6);
            call add_concept_answer(@concept_id, @child7_concept_id, 7);
            call add_concept_answer(@concept_id, @child8_concept_id, 8);
        </sql>
    </changeSet>

    <changeSet id="MALAWI_CONFIG_20210914112419847" author="Tarun">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("Negative", "Positive", "Unknown")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "LB, HIV enzyme immunoassay, qualitative");
            </sqlCheck>
        </preConditions>
        <comment>Adding Answers to LB, HIV enzyme immunoassay, qualitative</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "LB, HIV enzyme immunoassay, qualitative" and
            concept_name_type = "FULLY_SPECIFIED" and locale = "en" and voided = 0;
            set @child1_concept_id = 0;
            set @child2_concept_id = 0;
            set @child3_concept_id = 0;
            select concept_id into @child1_concept_id from concept_name where name ="Negative" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child2_concept_id from concept_name where name ="Positive" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child3_concept_id from concept_name where name ="Unknown" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            call add_concept_answer(@concept_id, @child1_concept_id, 1);
            call add_concept_answer(@concept_id, @child2_concept_id, 2);
            call add_concept_answer(@concept_id, @child3_concept_id, 3);
        </sql>
    </changeSet>

    <changeSet id="MALAWI_CONFIG_20210914112419860" author="Tarun">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_reference_term
                where code in
                ("699","161440","161441","161442","1874","1875","692","690","160912","696","21","694","790","160523","163680","654","653","1017","159734","1230","1231","785","300","1132","856","701","162096","1042","161134","1643","848","1364","1365","1362","1363","165398","1369","165390","165392")
                and retired = 0
                and concept_source_id = (
                select concept_source_id from concept_reference_source where name = "CEIL"  and retired =0
                );
            </sqlCheck>
        </preConditions>
        <comment>Adding CEIL codes to concepts</comment>
        <sql>
            SELECT concept_source_id INTO @source_id FROM concept_reference_source where name = "CEIL";

            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"699",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"161440",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"161441",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"161442",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"1874",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"1875",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"692",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"690",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"160912",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"696",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"21",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"694",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"790",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"160523",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"163680",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"654",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"653",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"1017",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"159734",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"1230",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"1231",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"785",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"300",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"1132",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"856",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"701",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"162096",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"1042",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"161134",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"1643",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"848",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"1364",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"1365",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"1362",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"1363",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"165398",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"1369",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"165390",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"165392",@source_id,uuid(),now());
            call CREATE_REFERENCE_MAPPING_CEIL("LB, Urine leukocyte esterase test","161441");
            call CREATE_REFERENCE_MAPPING_CEIL("LB, Creatinine clearance test","161134");
            call CREATE_REFERENCE_MAPPING_CEIL("LB, Urine nitrite test","161440");
            call CREATE_REFERENCE_MAPPING_CEIL("Trace","1874");
            call CREATE_REFERENCE_MAPPING_CEIL("LB, Serum glutamic-oxaloacetic transaminase","653");
            call CREATE_REFERENCE_MAPPING_CEIL("LB, Urine pregnancy test","45");
            call CREATE_REFERENCE_MAPPING_CEIL("1+","1362");
            call CREATE_REFERENCE_MAPPING_CEIL("LB, Fasting blood glucose measurement","160912");
            call CREATE_REFERENCE_MAPPING_CEIL("B+","694");
            call CREATE_REFERENCE_MAPPING_CEIL("LB, Date recorded","162869");
            call CREATE_REFERENCE_MAPPING_CEIL("LB, Blood typing","300");
            call CREATE_REFERENCE_MAPPING_CEIL("LB, Urine protein (dip stick)","1875");
            call CREATE_REFERENCE_MAPPING_CEIL("LB, Glucose measurement, qualitative, urine","159734");
            call CREATE_REFERENCE_MAPPING_CEIL("LB, Serum creatinine","790");
            call CREATE_REFERENCE_MAPPING_CEIL("LB, Other test performed","165398");
            call CREATE_REFERENCE_MAPPING_CEIL("LB, Mean cell haemoglobin concentration","1017");
            call CREATE_REFERENCE_MAPPING_CEIL("LB, Urobilinogen","1369");
            call CREATE_REFERENCE_MAPPING_CEIL("LB, Urine ketone test","161442");
            call CREATE_REFERENCE_MAPPING_CEIL("O+","699");
            call CREATE_REFERENCE_MAPPING_CEIL("LB, Serum albumin","848");
            call CREATE_REFERENCE_MAPPING_CEIL("A-","692");
            call CREATE_REFERENCE_MAPPING_CEIL("LB, Alkaline phosphatase","785");
            call CREATE_REFERENCE_MAPPING_CEIL("LB, HIV enzyme immunoassay, qualitative","1042");
            call CREATE_REFERENCE_MAPPING_CEIL("AB-","1231");
            call CREATE_REFERENCE_MAPPING_CEIL("LB, Bilirubin total presence in urine by test strip","163680");
            call CREATE_REFERENCE_MAPPING_CEIL("A+","690");
            call CREATE_REFERENCE_MAPPING_CEIL("2+","1363");
            call CREATE_REFERENCE_MAPPING_CEIL("Regular follow up visit","160523");
            call CREATE_REFERENCE_MAPPING_CEIL("LB, Haemoglobin","21");
            call CREATE_REFERENCE_MAPPING_CEIL("AB+","1230");
            call CREATE_REFERENCE_MAPPING_CEIL("B-","696");
            call CREATE_REFERENCE_MAPPING_CEIL("3+","1364");
            call CREATE_REFERENCE_MAPPING_CEIL("O-","701");
            call CREATE_REFERENCE_MAPPING_CEIL("LB, HIV viral load","856");
            call CREATE_REFERENCE_MAPPING_CEIL("LB, Serum glutamic-pyruvic transaminase","654");
            call CREATE_REFERENCE_MAPPING_CEIL("4+","1365");
            call CREATE_REFERENCE_MAPPING_CEIL("LB, Urine dipstick for blood","162096");
            call CREATE_REFERENCE_MAPPING_CEIL("LB, Rapid test for malaria","1643");
            call CREATE_REFERENCE_MAPPING_CEIL("LB, CD4 count","5497");
            call CREATE_REFERENCE_MAPPING_CEIL("LB, Serum sodium","1132");
            call CREATE_REFERENCE_MAPPING_CEIL("Growth","165390");
            call CREATE_REFERENCE_MAPPING_CEIL("No Growth","165392");
        </sql>
    </changeSet>

    <changeSet id="MALAWI_CONFIG_20210914112419870" author="Tarun">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_reference_term
                where code in
                ("MSFF97","MSFF99","MSFF98","MSFF100")
                and retired = 0
                and concept_source_id = (
                select concept_source_id from concept_reference_source where name = "MSFOCP"  and retired =0
                );
            </sqlCheck>
        </preConditions>
        <comment>Adding MSFOCP codes to concepts</comment>
        <sql>
            SELECT concept_source_id INTO @source_id FROM concept_reference_source where name = "MSFOCP";

            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"MSFF97",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"MSFF99",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"MSFF98",@source_id,uuid(),now());
            INSERT INTO concept_reference_term (creator,code,concept_source_id,uuid,date_created) VALUES (1,"MSFF100",@source_id,uuid(),now());
            call CREATE_REFERENCE_MAPPING_MSFOCP("LB, Other type of visit","MSFF99");
            call CREATE_REFERENCE_MAPPING_MSFOCP("LB, Type of visit","MSFF97");
            call CREATE_REFERENCE_MAPPING_MSFOCP("Baseline","MSFF98");
            call CREATE_REFERENCE_MAPPING_MSFOCP("LB, Blood culture result","MSFF100");
        </sql>
    </changeSet>

    <changeSet id="MALAWI_CONFIG_20211231112404020" author="Venky">
        <comment>Adding Concepts for Laboratory Form version2</comment>
        <sqlFile path="openmrs/data/configuration/liquibase/Laboratory/Laboratory_2.sql"/>
    </changeSet>

    <changeSet id="MALAWI_CONFIG_20211231112404021" author="Venky">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                select count(*) from concept_answer ca
                join
                concept_name cn
                on ca.concept_id = cn.concept_id
                where ca.answer_concept IN (select concept_id from concept_name where name IN
                ("OPD", "IPD", "OT", "4B", "Other")
                and concept_name_type = "FULLY_SPECIFIED")
                AND
                cn.concept_id IN (select concept_id from concept_name where name = "LB, Location");
            </sqlCheck>
        </preConditions>
        <comment>Adding Answers to LB, Location</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "LB, Location" and
            concept_name_type = "FULLY_SPECIFIED" and locale = "en" and voided = 0;
            set @child1_concept_id = 0;
            set @child2_concept_id = 0;
            set @child3_concept_id = 0;
            set @child4_concept_id = 0;
            set @child5_concept_id = 0;
            select concept_id into @child1_concept_id from concept_name where name ="OPD" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child2_concept_id from concept_name where name ="IPD" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child3_concept_id from concept_name where name ="OT" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child4_concept_id from concept_name where name ="4B" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            select concept_id into @child5_concept_id from concept_name where name ="Other" and concept_name_type ="FULLY_SPECIFIED" and locale ="en" and voided = 0;
            call add_concept_answer(@concept_id, @child1_concept_id, 1);
            call add_concept_answer(@concept_id, @child2_concept_id, 2);
            call add_concept_answer(@concept_id, @child3_concept_id, 3);
            call add_concept_answer(@concept_id, @child4_concept_id, 4);
            call add_concept_answer(@concept_id, @child5_concept_id, 5);
        </sql>
    </changeSet>

    <changeSet id="MALAWI_CONFIG_20211231112404022" author="Venky">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult = "1">
            select count(*) from concept_name where name = "LB, Serum glutamic-oxaloacetic transaminase" and concept_name_type = "FULLY_SPECIFIED"  and locale = "en"  and voided = 0;
            </sqlCheck>
        </preConditions>
        <comment>Restricting range for LB, Serum glutamic-oxaloacetic transaminase concept</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "LB, Serum glutamic-oxaloacetic transaminase" and concept_name_type = "FULLY_SPECIFIED"  and locale = "en"  and voided = 0;
            update concept_numeric set hi_normal=50, low_normal=0, low_absolute=-0.0000000001  where concept_id = @concept_id;
        </sql>
    </changeSet>

    <changeSet id="MALAWI_CONFIG_20211231112404023" author="Venky">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult = "1">
            select count(*) from concept_name where name = "LB, Serum glutamic-pyruvic transaminase" and concept_name_type = "FULLY_SPECIFIED"  and locale = "en"  and voided = 0;
            </sqlCheck>
        </preConditions>
        <comment>Restricting range for LB, Serum glutamic-pyruvic transaminase concept</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "LB, Serum glutamic-pyruvic transaminase" and concept_name_type = "FULLY_SPECIFIED"  and locale = "en"  and voided = 0;
            update concept_numeric set hi_normal=37, low_normal=0, low_absolute=-0.0000000001 where concept_id = @concept_id;
        </sql>
    </changeSet>

    <changeSet id="MALAWI_CONFIG_20220131112404020" author="Venky">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult = "1">
            select count(*) from concept_name where name = "LB, Serum glutamic-oxaloacetic transaminase" and concept_name_type = "FULLY_SPECIFIED"  and locale = "en"  and voided = 0;
            </sqlCheck>
        </preConditions>
        <comment>changing help text for LB, Serum glutamic-oxaloacetic transaminase concept</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "LB, Serum glutamic-oxaloacetic transaminase" and concept_name_type = "FULLY_SPECIFIED"  and locale = "en"  and voided = 0;
            update concept_description set description="Normal range: 0 - 50" where concept_id = @concept_id;
        </sql>
    </changeSet>

    <changeSet id="MALAWI_CONFIG_20220131112404021" author="Venky">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult = "1">
            select count(*) from concept_name where name = "LB, Serum glutamic-pyruvic transaminase" and concept_name_type = "FULLY_SPECIFIED"  and locale = "en"  and voided = 0;
            </sqlCheck>
        </preConditions>
        <comment>changing help text for LB, Serum glutamic-pyruvic transaminase concept</comment>
        <sql>
            select concept_id into @concept_id from concept_name where name = "LB, Serum glutamic-pyruvic transaminase" and concept_name_type = "FULLY_SPECIFIED"  and locale = "en"  and voided = 0;
            update concept_description set description="Normal range: 0 - 37" where concept_id = @concept_id;
        </sql>
    </changeSet>

</databaseChangeLog>
